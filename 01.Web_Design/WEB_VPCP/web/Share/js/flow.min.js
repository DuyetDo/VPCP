function findPos(e){var t=0,o=0;if(e.offsetParent){do t+=e.offsetLeft,o+=e.offsetTop;while(e=e.offsetParent);return{x:t,y:o}}return void 0}drawFlow=function(e){color_processing="rgb(113,153,236)",color_finish="rgb(230,193,119)",color_border="rgb(200,163,89)",color_anchor="rgb(200,163,89)",color_active="rgb(255,100,100)",fixedWidth=0,fixedHeight=0,firstSelectNode=null,endSelectNode=null,select=0,buttonType=null,nodeList=new Array,nodeToNodeList=new Array,nodeLength=0,nodeToNodeLength=0,nodeHeight=40,nodeWidth=100,nodeRadius=20,activeNode=-1,activeLine=-1,hintNode=-1,xpoint=0,ypoint=0,mouseFlags=0,maxId=0,isChangeGraph=!1,this.id=e,this.flowId=0,this.setFlowData=function(e){if(this.flowId=e.flowId,nodeList=new Array,nodeToNodeList=new Array,nodeLength=0,nodeToNodeLength=0,null!=e.lstNodes&&e.lstNodes.length>0)for(var t=0;t<e.lstNodes.length;t++){var o=e.lstNodes[t];this.addNode(o.nodeId,o.nodeName,o.left,o.top,o.right,o.bottom,o.status,o.type)}if(null!=e.lstNodeToNodes&&e.lstNodeToNodes.length>0)for(var t=0;t<e.lstNodeToNodes.length;t++){var o=e.lstNodeToNodes[t];this.addRelation(o.previousId,o.nextId,o.action,o.type,o.specialActionLabel)}this.drawGraph()},this.getNodeList=function(){return nodeList},this.changeAccessory=function(){0==select?select=1:select=0},this.setSelect=function(e){select=e},this.setButtonType=function(e){buttonType=e},getNextIdOfNode=function(){return maxId+=1,maxId},this.updateNodeId=function(e,t){for(var o=0;o<nodeLength;o++)if(nodeList[o].id==e){nodeList[o].nodeId=t;break}},this.addRelation=function(e,t,o,n,i){for(var d=-1,s=-1,r=0;r<nodeList.length;r++)nodeList[r].nodeId==e&&(d=r),nodeList[r].nodeId==t&&(s=r);for(var a=!0,r=0;r<nodeToNodeList.length;r++)if(nodeToNodeList[r].previousId==d&&nodeToNodeList[r].nextId==s){a=!1;break}if(a){var l=new Object;l.previousId=d,l.nextId=s,l.action=o,l.type=n,l.specialActionLabel=i,nodeToNodeList[nodeToNodeLength]=l,nodeToNodeLength++}this.drawGraph()},this.addNode=function(e,t,o,n,i,d,s,r,a){var l=new Object;l.id=getNextIdOfNode(),l.nodeName=t,l.status=s,l.nodeId=e,l.type=r,l.left=o,l.top=n,l.right=i,l.bottom=d,null!=a?l.color=a:l.color=color_processing,nodeList[nodeLength]=l,nodeLength+=1,console.log("nodeId="+l.nodeId),this.drawGraph()},this.addNewNode=function(e,t){var o=zk.Widget.$("$flowConfigDlg"),n=null;activeNode>=0&&(n=nodeList[activeNode]);var i={previousNode:n,typeNode:t};zAu.send(new zk.Event(o,"onAddNewNode",JSON.stringify(i)))},this.addGraph=function(e,t,o){this.addNode(nodeLength,o.nodeName,e*(nodeWidth+20),t*(nodeHeight+20),color_processing,0==nodeLength?null:nodeLength-1);for(var n=o.childs.length,i=0;n>i;i++)this.addGraph(e+1,t+i,o.childs[i])},this.addNextNode=function(e,t){var o=new Object;o.id=getNextIdOfNode(),o.nodeName=t,o.nodeId=e,o.previousId=nodeLength-1,0==nodeLength?(o.left=10,o.top=10):(o.left=nodeList[nodeLength-1].right+50,o.top=nodeList[nodeLength-1].top),o.color=color_processing,nodeList[nodeLength]=o,nodeLength+=1,this.drawGraph()},this.clearNode=function(){nodeList=new Array,nodeLength=0,this.drawGraph()},this.deleteNode=function(e){var t=zk.Widget.$("$flowConfigDlg");activeNode>=0&&zAu.send(new zk.Event(t,"onDeleteNode",JSON.stringify(nodeList[activeNode])))},this.deleteNodeToNode=function(e,t){var o=zk.Widget.$("$flowConfigDlg");if(activeLine>=0)for(var n=nodeList[nodeToNodeList[activeLine].previousId].nodeId,i=nodeList[nodeToNodeList[activeLine].nextId].nodeId,d=0;d<page.flow.lstNodeToNodes.length;d++){var s=page.flow.lstNodeToNodes[d];if(s.nextId==i&&s.previousId==n){zAu.send(new zk.Event(o,"onDeleteNodeToNode",JSON.stringify(s)));break}}},this.checkIEVersion=function(){var e=!1,t={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var o=e[t].string,n=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,o){if(-1!=o.indexOf(e[t].subString))return e[t].identity}else if(n)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};return t.init(),"Firefox"==t.browser?t.version>9&&(e=!0):"Chrome"==t.browser?t.version>9&&(e=!0):"Explorer"==t.browser&&t.version>9&&(e=!0),e},this.nodeToJSON=function(){var e={flowId:this.flowId,lstNodes:nodeList,lstNodeToNodes:nodeToNodeList};return e},this.nodeToJSONOld=function(){for(var e={},t=0,o=0;o<nodeList.length;o++)e["lstNodes["+o+"].id"]||(e["lstNodes["+o+"].id"]=[]),e["lstNodes["+o+"].flowId"]||(e["lstNodes["+o+"].flowId"]=[]),e["lstNodes["+o+"].nodeId"]||(e["lstNodes["+o+"].nodeId"]=[]),e["lstNodes["+o+"].nodeName"]||(e["lstNodes["+o+"].nodeName"]=[]),e["lstNodes["+o+"].x"]||(e["lstNodes["+o+"].x"]=[]),e["lstNodes["+o+"].y"]||(e["lstNodes["+o+"].y"]=[]),e["lstNodes["+o+"].status"]||(e["lstNodes["+o+"].status"]=[]),e["lstNodes["+o+"].id"].push(nodeList[o].id),nodeList[o].nodeId&&e["lstNodes["+o+"].nodeId"].push(nodeList[o].nodeId),t&&e["lstNodes["+o+"].flowId"].push(t),e["lstNodes["+o+"].nodeName"].push(nodeList[o].nodeName),null==nodeList[o].x?e["lstNodes["+o+"].x"].push(0):e["lstNodes["+o+"].x"].push(nodeList[o].left),null==nodeList[o].y?e["lstNodes["+o+"].y"].push(0):e["lstNodes["+o+"].y"].push(nodeList[o].top),null==nodeList[o].status?e["lstNodes["+o+"].status"].push(0):e["lstNodes["+o+"].status"].push(nodeList[o].status);for(var o=0;o<nodeToNodeList.length;o++)e["lstNodeToNodes["+o+"].previousId"]||(e["lstNodeToNodes["+o+"].previousId"]=[]),e["lstNodeToNodes["+o+"].nextId"]||(e["lstNodeToNodes["+o+"].nextId"]=[]),e["lstNodeToNodes["+o+"].action"]||(e["lstNodeToNodes["+o+"].action"]=[]),e["lstNodeToNodes["+o+"].previousId"].push(nodeToNodeList[o].previousId),e["lstNodeToNodes["+o+"].nextId"].push(nodeToNodeList[o].nextId),e["lstNodeToNodes["+o+"].action"].push(nodeToNodeList[o].action);return e},this.nodeToNodeToJson=function(){var e=JSON.stringify({nodeToNodeList:nodeToNodeList});return e},drawRectangle=function(e,t,o,n,i,d,s){e.beginPath(),e.fillStyle=s,e.moveTo(o,n),e.lineTo(o+d,n),e.lineTo(o+d,n+i),e.lineTo(o,n+i),e.lineTo(o,n),e.fill(),e.stroke(),e.closePath(),e.fillStyle="#FFF",e.fillText(t,o+10,n+i/2,d,i)},drawRect=function(e,t){var o=4;e.moveTo(t.left+o,t.top),e.lineTo(t.right-o,t.top),e.arc(t.right-o,t.top+o,o,3*Math.PI/2,2*Math.PI),e.lineTo(t.right,t.bottom-o),e.arc(t.right-o,t.bottom-o,o,0,Math.PI/2),e.lineTo(t.left+o,t.bottom),e.arc(t.left+o,t.bottom-o,o,Math.PI/2,Math.PI),e.lineTo(t.left,t.top+o),e.arc(t.left+o,t.top+o,o,Math.PI,3*Math.PI/2),e.fill()},drawStart=function(e,t){var o=nodeRadius;e.arc(t.left+o,t.top+o,o,0,2*Math.PI),e.fillStyle="#BBCCEE",e.fill()},drawEnd=function(e,t){var o=nodeRadius;e.arc(t.left+o,t.top+o,o,0,2*Math.PI),e.fillStyle="#112233",e.fill()},drawNode=function(e,t){e.beginPath(),e.fillStyle=t.color,2==t.type?drawStart(e,t):3==t.type?drawEnd(e,t):drawRect(e,t),e.closePath(),e.fillStyle="#000",e.font="12px verdana";var o=t.nodeName.toString();o.length>10&&(o=o.substring(0,10)+".."),e.fillText(o,t.left+10,t.top+nodeHeight/2,t.right-t.left)},drawActiveNode=function(e,t){e.beginPath(),e.fillStyle=t.color,e.fillStyle="#AABBCC",2==t.type?drawStart(e,t):3==t.type?drawEnd(e,t):drawRect(e,t),e.stroke(),e.closePath(),e.fillStyle="#000",e.font="12px verdana";var o=t.nodeName.toString();o.length>10&&(o=o.substring(0,10)+".."),e.fillText(o,t.left+10,t.top+nodeHeight/2,t.right-t.left)},drawTooltip=function(e,t){if(null!=t&&void 0!=t){var o=e.font;e.font="13px verdana";var n="Node : "+t.nodeName,i=e.measureText(n),d=i.width+10;e.beginPath(),e.fillStyle="rgba(255,100,100,0.3)",e.moveTo((t.left+t.right)/2,t.bottom),e.lineTo((t.left+t.right)/2-2,t.bottom+6),e.lineTo(t.left,t.bottom+6),e.lineTo(t.left,t.bottom+6+37),e.lineTo(t.left+d,t.bottom+6+37),e.lineTo(t.left+d,t.bottom+6),e.lineTo((t.left+t.right)/2+2,t.bottom+6),e.lineTo((t.left+t.right)/2,t.bottom),e.fill();var s=e.strokeStyle;e.strokeStyle="rgba(255,100,100,0.3)",e.stroke(),e.strokeStyle=s,e.closePath(),e.fillStyle="#000",e.fillText(n,t.left+5,t.bottom+20),e.font=o}},getCenterpoint=function(e,t,o,n){var i=new Object;if(t==n)console.log("y1==y2"),i.x=(e+o)/2,console.log("after set x"),i.y=t+Math.sqrt(3)/2*(o-e),console.log("after set y"),i.r=Math.abs(o-e),console.log("after set x,y,r"),o>e?(console.log("x2>x1"),i.a1=4*Math.PI/3,i.a2=5*Math.PI/3):(console.log("x2<x1"),i.a1=Math.PI/3,i.a2=2*Math.PI/3);else if(e==o)console.log("x1==x2"),i.y=(t+n)/2,i.x=e+Math.sqrt(3)/2*(n-t),i.r=Math.abs(n-t),n>t?(i.a1=5*Math.PI/6,i.a2=i.a1+Math.PI/3):(i.a1=-1*Math.PI/6,i.a2=Math.PI/6);else{console.log("x1 !=x2 && y1 != y2"),i.r=Math.sqrt((n-t)*(n-t)+(o-e)*(o-e));var d=Math.atan((n-t)/(o-e));i.a1=4/3*Math.PI+d,i.a2=5/3*Math.PI+d,o>e?(i.x=e-Math.cos(i.a1)*i.r,i.y=t-Math.sin(i.a1)*i.r):(i.a1+=Math.PI,i.a2+=Math.PI,i.x=e-Math.cos(i.a1)*i.r,i.y=t-Math.sin(i.a1)*i.r)}return i},drawAnchor=function(e,t,o,n,i,d){var s=getCenterpoint(t,o,n,i);e.beginPath(),2==d?e.setLineDash([5,2]):e.setLineDash([]),e.arc(s.x,s.y,s.r,s.a1,s.a2),e.stroke(),e.beginPath();var r,a,l,h,c=Math.atan((o-i)/(n-t)),f=c-2*Math.PI/6,g=c,N=10;n>=t?(r=n-Math.cos(f)*N,a=i+Math.sin(f)*N,l=n-Math.cos(g)*N,h=i+Math.sin(g)*N):(r=n+Math.cos(f)*N,a=i-Math.sin(f)*N,l=n+Math.cos(g)*N,h=i-Math.sin(g)*N),e.moveTo(n,i),e.lineTo(r,a),e.moveTo(n,i),e.lineTo(l,h),e.closePath(),e.stroke()},drawLineAnchor=function(e,t,o,n,i,d){var s,r,a,l,h=Math.atan((o-i)/(n-t)),c=h+Math.PI/6,f=h-Math.PI/6,g=10;n>=t?(s=n-Math.cos(c)*g,r=i+Math.sin(c)*g,a=n-Math.cos(f)*g,l=i+Math.sin(f)*g):(s=n+Math.cos(c)*g,r=i-Math.sin(c)*g,a=n+Math.cos(f)*g,l=i-Math.sin(f)*g),e.beginPath(),2==d&&e.setLineDash([5,2]),e.moveTo(t,o),e.lineTo(n,i),e.lineTo(s,r),e.moveTo(n,i),e.lineTo(a,l),e.stroke(),2==d&&e.setLineDash([0,0]),e.closePath()},getLinePoints=function(e,t){var o=e.right,n=(e.top+e.bottom)/2,i=t.left,d=(t.top+t.bottom)/2;e.right<t.left?(o=e.right,i=t.left):e.left>=t.right?(o=e.left,i=t.right):e.bottom<t.top?(o=(e.left+e.right)/2,n=e.bottom,i=(t.left+t.right)/2,d=t.top):e.top>t.bottom&&(o=(e.left+e.right)/2,n=e.top,i=(t.left+t.right)/2,d=t.bottom);var s={x1:o,x2:i,y1:n,y2:d};return s},drawNodeToNode=function(e,t,o,n,i,d){var s=getLinePoints(t,o);if(d?(e.lineWidth=2,e.strokeStyle="rgb(0,0,255)",drawAnchor(e,s.x1,s.y1,s.x2,s.y2,i),e.strokeStyle="rgb(0,0,0)",e.lineWidth=1):drawAnchor(e,s.x1,s.y1,s.x2,s.y2,i),null!=n&&""!=n){var r=(s.x1+s.x2)/2,a=(s.y1+s.y2)/2,l=Math.sqrt((s.x1-s.x2)*(s.x1-s.x2)+(s.y1-s.y2)*(s.y1-s.y2)),h=(1-Math.sqrt(3)/2)*l;s.x1<s.x2?a-=h:a+=h,s.y1<s.y2?r+=h:r-=h;var c=e.measureText(n).width;e.fillText(n,r-c/2,a)}},adjustNodePosition=function(){},this.resize=function(e,t){fixedWidth=e,fixedHeight=t,this.drawGraph()},this.drawGraph=function(){try{for(var t=document.getElementById(e),o=!1,n=0;n<nodeLength;n++)nodeList[n].right>fixedWidth&&(fixedWidth=nodeList[n].right,o=!0),nodeList[n].bottom>fixedHeight&&(fixedHeight=nodeList[n].bottom,o=!0);o&&(t.style.width=fixedWidth+"px",t.style.height=fixedHeight+"px"),t.width=fixedWidth,t.height=fixedHeight;var i=t.getContext("2d");if(i.font="bold 12pt Arial",nodeLength>0){for(var n=0;n<nodeLength;n++)n==activeNode?drawActiveNode(i,nodeList[n]):drawNode(i,nodeList[n]);for(var n=0;n<nodeToNodeLength;n++){var d=!1;n==activeLine&&(d=!0);try{drawNodeToNode(i,nodeList[nodeToNodeList[n].previousId],nodeList[nodeToNodeList[n].nextId],nodeToNodeList[n].specialActionLabel,nodeToNodeList[n].type,d)}catch(s){}}drawTooltip(i,nodeList[hintNode])}}catch(s){console.log(s)}},this.nodeOver=function(e,t){var o=0;for(o=0;o<nodeList.length;o++)if(isInNode(e,t,nodeList[o]))return o;return-1},isInNode=function(e,t,o){return null==o?!1:e>=o.left&&e<=o.right&&t>=o.top&&t<=o.bottom?!0:!1},this.curveyOver=function(e,t){var o,n,i,d,s,r=0;for(r=0;r<nodeToNodeList.length;r++)if(o=getLinePoints(nodeList[nodeToNodeList[r].previousId],nodeList[nodeToNodeList[r].nextId]),n=o.x1,d=o.y1,o.x1>=o.x2?(n=o.x2,i=o.x1):(n=o.x1,i=o.x2),o.y1>=o.y2?(d=o.y2,s=o.y1):(d=o.y1,s=o.y2),n-=40,i+=40,d-=40,s+=40,!(n>e||e>i||d>t||t>s)){var a=getCenterpoint(o.x1,o.y1,o.x2,o.y2),l=Math.sqrt((a.x-e)*(a.x-e)+(a.y-t)*(a.y-t));if(Math.abs(a.r-l)<=10)return r}return-1},this.lineOver=function(e,t){var o,n,i,d,s,r=0;for(r=0;r<nodeToNodeList.length;r++)if(o=getLinePoints(nodeList[nodeToNodeList[r].previousId],nodeList[nodeToNodeList[r].nextId]),n=o.x1,d=o.y1,o.x1>=o.x2?(n=o.x2,i=o.x1):(n=o.x1,i=o.x2),o.y1>=o.y2?(d=o.y2,s=o.y1):(d=o.y1,s=o.y2),n-=10,i+=10,d-=10,s+=10,!(n>e||e>i||d>t||t>s))if(o.x1==o.x2){if(Math.abs(e-o.x1)<=10)return r}else{var a=(o.y1-o.y2)/(o.x1-o.x2),l=(o.y2*o.x1-o.y1*o.x2)/(o.x1-o.x2),h=a*e+l;if(Math.abs(h-t)<=10)return r}return-1},this.whereIsActiveNode=function(e,t){var o=0;if(1==mouseFlags){if(console.log("here"),activeNode>=0){console.log("active node");var n=nodeList[activeNode].right-nodeList[activeNode].left,i=nodeList[activeNode].bottom-nodeList[activeNode].top;nodeList[activeNode].left=e,nodeList[activeNode].top=t,nodeList[activeNode].right=e+n,nodeList[activeNode].bottom=t+i,console.log("before draw"),this.drawGraph()}}else{for(o=0;o<nodeList.length;o++)if(isInNode(e,t,nodeList[o]))return hintNode!=o?(hintNode=o,void this.drawGraph()):void 0;-1!=hintNode&&(hintNode=-1,this.drawGraph())}},this.clickInGraph=function(e,t){console.log("clickInGraphic");var o=document.getElementById("txtNodeName");null!=o&&""==o.style.display&&(o.style.display="none");var n=!1,i=this.nodeOver(e,t);if(i!=activeNode&&(activeNode=i,n=!0),activeNode<0){var d=this.curveyOver(e,t);d!=activeLine&&(activeLine=d,n=!0)}else if(activeLine=-1,activeNode>=0&&0==select&&(mouseFlags=1),1==select)firstSelectNode=activeNode,select=2;else if(2==select){var s=!0;if(firstSelectNode==activeNode)s=!1;else for(var r=0;r<nodeToNodeLength;r++)if(nodeToNodeList[r].previousId==firstSelectNode&&nodeToNodeList[r].nextId==activeNode){s=!1;break}if(s){var a=new Object;a.previousId=nodeList[firstSelectNode].nodeId,a.nextId=nodeList[activeNode].nodeId,a.type=buttonType;var l=zk.Widget.$("$flowConfigDlg");zAu.send(new zk.Event(l,"onAddNodeToNode",JSON.stringify(a)))}select=1}n&&this.drawGraph()},this.updateFromForm=function(){for(var e=document.getElementById("viewNodeForm.nodeName").value,t=document.getElementById("viewNodeForm.nodeId").value,o=document.getElementById("viewNodeForm.status").value,n=document.getElementById("viewNodeForm.id").value=nodeList[activeNode].id,i=dijit.byId("nodeToNodeGrid"),d=0;d<=nodeLength;d++)if(nodeList[d].id==n){nodeList[d].nodeId=t,nodeList[d].nodeName=e,nodeList[d].status=o;break}for(var d=nodeToNodeLength-1;d>=0;d--)if(nodeList[nodeToNodeList[d].previousId].id==n){for(var s=!1,r=0;r<i._by_idx.length;r++){var a=i.getItem(r);if(a.nextId==nodeToNodeList[d].nextId){s=!0,nodeToNodeList[d].action=a.action;break}}s||(nodeToNodeList.splice(d,1),nodeToNodeLength--)}this.drawGraph()},this.showNodeContent=function(){var e=zk.Widget.$("$flowConfigDlg");if(activeNode>=0&&(nodeData=nodeList[activeNode],nodeData.flowId=this.flowId,zAu.send(new zk.Event(e,"onLoadNodeData",JSON.stringify(nodeData)))),activeLine>=0){var t=page.flow.lstNodeToNodes[activeLine];zAu.send(new zk.Event(e,"onLoadNodeToNode",JSON.stringify(t)))}},this.mouseUp=function(){if(mouseFlags=0,isChangeGraph||(isChangeGraph=!0),activeNode>=0){var e=zk.Widget.$("$flowConfigDlg");zAu.send(new zk.Event(e,"onUpdatePositionNode",JSON.stringify(nodeList[activeNode])))}},this.keyPress=function(e){var t=document.getElementById("txtNodeName");if(null!=t){var o,n,i,d,s=(document.getElementById("flowNode"),!1);activeNode>=0||activeLine>=0,s&&(t.style.top=n+"px",t.style.left=o+"px",t.style.width=i+"px",t.style.height=d+"px",t.style.display="",t.value="",t.focus()),isChangeGraph||(isChangeGraph=!0)}},this.setActiveNodeText=function(e){activeNode<0||(nodeList[activeNode].nodeName=e,this.drawGraph())},this.setActiveLineText=function(e){activeLine<0||(nodeToNodeList[activeLine].action=e,this.drawGraph())}},drawProcess=function(e){var t=new drawFlow(e);if(t.checkIEVersion()){var o=document.getElementById(e),n=o.clientWidth,i=o.clientHeight;return document.getElementById(e).onmousedown=function(o){var n=document.getElementById(e),i=n.parentNode,d=findPos(n),s=o.pageX-d.x+i.scrollLeft,r=o.pageY-d.y+i.scrollTop;return t.clickInGraph(s,r),!1},document.getElementById(e).onmouseup=function(e){t.mouseUp()},document.getElementById(e).ondblclick=function(e){return t.showNodeContent(),!1},document.getElementById(e).onmousemove=function(o){var n=document.getElementById(e),i=n.parentNode,d=findPos(n),s=o.pageX-d.x+i.scrollLeft,r=o.pageY-d.y+i.scrollTop;t.whereIsActiveNode(s,r)},t.resize(n,i),t}};